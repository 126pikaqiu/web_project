<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
	<link type="text/css" rel="stylesheet" href="static/h-ui/css/H-ui.css"/>
	<link type="text/css" rel="stylesheet" href="static/h-ui.admin/css/H-ui.admin.css"/>
	<title>用户查看</title>
</head>
<body>
<!--<script type="text/javascript" src="../templates/js/api/index.js" ></script>-->
<!--<script type="text/javascript" src="../templates/js/api/users.js" ></script>-->
<div class="cl pd-20" style="background-color:#5bacb6">
	<img class="avatar avatar-XL l" src="../templates/img/web_img/logo.png" alt="头像">
	<dl style="margin-left:80px; color:#fff">
		<dt><span class="f-18" id="username"></span> </dt>
		<dd class="pt-10 f-12" style="margin-left:0" id="signature">这家伙很懒，什么也没有留下</dd>
	</dl>
</div>
<div class="pd-20">
	<table class="table">
		<tbody>
		<tr>
			<th class="text-r">手机：</th>
			<td id="mobile">13000000000</td>
		</tr>
		<tr>
			<th class="text-r">邮箱：</th>
			<td id="email">admin@mail.com</td>
		</tr>
		<tr>
			<th class="text-r">地址：</th>
			<td>北京市 海淀区</td>
		</tr>
		</tbody>
	</table>
	<table class="table">
		<thead>
		<tr>
			<td><strong>最近收藏</strong></td>
		</tr>
		</thead>
		<tbody id="public-collecions">
		<tr><td>无</td></tr>
		</tbody>
	</table>
</div>
<script type="text/javascript">
	function ospn(itemID) {
		window.open("/item.jsp?id=" + itemID);
    }
    function getUrlVars(){
        var vars = [], hash;
        var hashes = window.location.href.slice(window.location.href.indexOf('?')+1).split('&');
        for(var i = 0; i < hashes.length; i++) {
            hash = hashes[i].split('=');
            vars.push(hash[0]);
            vars[hash[0]] = hash[1];
        }
        return vars;
    }
    $(document).ready(function () {
        GetUserInfor();
    });
    function getMobile() {
        let mobileChars = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
        let mobile = '1';
        for (let i = 0; i < 10; i++)
        {
            //获取随机验证码下标
            let charNum = Math.floor(Math.random() * 10);
            //组合成指定字符验证码
            mobile += mobileChars[charNum];
        }
        return mobile;
    }
    function GetUserInfor() {
        $.ajax({
			url:'/friends/info',
			type:'get',
			data:{'userID':getUrlVars()['id'],'want':'info'},
			success:function (data) {
			    data = eval('(' + data + ')');
			    let user=data["user"];
                $("#signature").html(user['signature']);
                $("#email").html(user['email']);
                $("#username").text(user['name']);
				$("#mobile").text(getMobile());
				let items=data["publicCollection"];
				if(items.length > 0){
				    let html='';
				    for(let index in items) {
				        html += '<tr><td><a href="javascript:;" onclick="ospn(' + items[index]['id'] + ')">' + items[index]['name'] +'</a></td></tr>'
					}
				    $("#public-collecions").html(html);

				}
            },
			error:function () {
				console.log('查看用户信息失败')
            }
		});
    }
</script>
</body>
</html>